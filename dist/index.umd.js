!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("lodash.difference"),require("lodash.intersection"),require("lodash.isplainobject"),require("lodash.mergewith")):"function"==typeof define&&define.amd?define(["lodash.difference","lodash.intersection","lodash.isplainobject","lodash.mergewith"],e):(t=t||self).entityQuery=e(t.difference,t.intersection,t.isObj,t.mergeWith)}(this,function(t,e,n,r){function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function c(t,e,n){return(c=i()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var u=new(Function.bind.apply(t,r));return n&&o(u,n.prototype),u}).apply(null,arguments)}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var f=Symbol(),a=new WeakMap;function l(o,i,l){if(void 0===i&&(i=f),i===f)return Object.keys(o);var s,O=a.get(o)||a.set(o,(s=o,Object.values(s).flatMap(function(t){return function(t){return function t(e,r){var u=function(t,e){if(null==t)return{};var n,r,u={},o=Object.keys(t);for(r=0;r<o.length;r++)e.indexOf(n=o[r])>=0||(u[n]=t[n]);return u}(e,["id"]);return Object.entries(u).flatMap(function(e){var u=e[0],o=e[1];return n(o)?t(o,d(u,r)):d(u+"__."+o,r)})}(t).map(function(e){return function(t,e){return e.reduceRight(function(n,r,u){var o,i;return e.length-1<=u?((o={})[r]=t,o):((i={})[r]=n,i)},{})}([t.id],e.split("__."))})}(t)}).reduce(function(t,e){return r(t,e,function(t,e){if(Array.isArray(t))return t.concat(e)})},{}))).get(o),v=(Array.isArray(i)?i:[i]).map(function(t){return function(t,r){return e.apply(void 0,function t(e,r){return Object.keys(e).flatMap(function(u){var o;return n(e[u])?t(e[u],d(u,r)):((o={})[d(u,r)]=e[u],o)})}(r).map(function(e){return function t(e,n,r){if(!n.length)return p(r)?y(e,h(r)).map(function(t){return e[t]}).flat():e[""+r];var o,i=n[0],c=n.slice(1);if(p(i)){var f=y(e,h(i));if(!f.length)return[];o=f.reduce(function(t,n){return u({},t,e[n]||{})},{})}else o=e[i];return o?t(o,c,r):[]}(t,Object.keys(e)[0].split("__."),Object.values(e)[0])}))}(O,t)});switch(l.conditions){case"all":return e.apply(void 0,v);case"any":return[].concat(c(Set,v));case"diff":return v.length>=2?t.apply(void 0,[v[0]].concat(v.slice(1))):[];case"none":return t.apply(void 0,[Object.keys(o)].concat(v));default:return e.apply(void 0,v)}}function s(t){return{conditions:null==t?void 0:t.conditions}}function p(t){try{return"string"==typeof t&&!!h(t)}catch(t){return!1}}function d(t,e){return void 0===e&&(e=f),e===f?""+t:e+"__."+t}function y(t,e){return Object.keys(t).filter(function(t){return e.test(t)})}function h(t){var e=t.slice(1,t.lastIndexOf("/")),n=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,n)}return function(t){return{filter:function(e,n){return l(t,e,s(n)).map(function(e){return t[e]})},search:function(e,n){return l(t,e,s(n))}}}});
//# sourceMappingURL=index.umd.js.map
