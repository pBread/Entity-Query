!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("lodash.difference"),require("lodash.intersection"),require("lodash.isplainobject"),require("lodash.mergewith")):"function"==typeof define&&define.amd?define(["lodash.difference","lodash.intersection","lodash.isplainobject","lodash.mergewith"],e):(t=t||self).entityQuery=e(t.difference,t.intersection,t.isObj,t.mergeWith)}(this,function(t,e,n,r){function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function c(t,e,n){return(c=i()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o}).apply(null,arguments)}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var f=Symbol(),a=new WeakMap;function l(u,i,l){if(void 0===i&&(i=f),i===f)return Object.keys(u);var s,O=a.get(u)||a.set(u,(s=u,Object.values(s).flatMap(function(t){return function(t){return function t(e,r){var o=function(t,e){if(null==t)return{};var n,r,o={},u=Object.keys(t);for(r=0;r<u.length;r++)e.indexOf(n=u[r])>=0||(o[n]=t[n]);return o}(e,["id"]);return Object.entries(o).flatMap(function(e){var o=e[0],u=e[1];return n(u)?t(u,d(o,r)):d(o+"__."+u,r)})}(t).map(function(e){return function(t,e){return e.reduceRight(function(n,r,o){var u,i;return e.length-1<=o?((u={})[r]=t,u):((i={})[r]=n,i)},{})}([t.id],e.split("__."))})}(t)}).reduce(function(t,e){return r(t,e,function(t,e){if(Array.isArray(t))return t.concat(e)})},{}))).get(u),v=(Array.isArray(i)?i:[i]).map(function(t){return function(t,r){return e.apply(void 0,function t(e,r){return Object.keys(e).flatMap(function(o){var u;return n(e[o])?t(e[o],d(o,r)):((u={})[d(o,r)]=e[o],u)})}(r).map(function(e){return function t(e,n,r){if(!n.length)return p(r)?y(e,h(r)).map(function(t){return e[t]}).flat():e[""+r];var u=n[0],i=n.slice(1),c=p(u)?y(e,h(u)).reduce(function(t,n){return o({},t,e[n]||{})},{}):e[u];return c?t(c,i,r):[]}(t,Object.keys(e)[0].split("__."),Object.values(e)[0])}))}(O,t)});switch(l.conditions){case"all":return e.apply(void 0,v);case"any":return[].concat(c(Set,v));case"diff":return v.length>=2?t.apply(void 0,[v[0]].concat(v.slice(1))):[];case"none":return t.apply(void 0,[Object.keys(u)].concat(v));default:throw Error("Invalid Query Conditon: "+l.conditions)}}function s(t){return{conditions:null==t?void 0:t.conditions}}function p(t){try{return"string"==typeof t&&!!h(t)}catch(t){return!1}}function d(t,e){return void 0===e&&(e=f),e===f?""+t:e+"__."+t}function y(t,e){return Object.keys(t).filter(function(t){return e.test(t)})}function h(t){var e=t.slice(1,t.lastIndexOf("/")),n=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,n)}return function(t){return{filter:function(e,n){return l(t,e,s(n)).map(function(e){return t[e]})},search:function(e,n){return l(t,e,s(n))}}}});
//# sourceMappingURL=index.umd.js.map
