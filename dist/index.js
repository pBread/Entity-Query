function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var n=t(require("lodash.difference")),r=t(require("lodash.intersection")),e=t(require("lodash.isplainobject")),u=t(require("lodash.mergewith"));function c(){return(c=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t}).apply(this,arguments)}function i(t,n){return(i=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function f(t,n,r){return(f=o()?Reflect.construct:function(t,n,r){var e=[null];e.push.apply(e,n);var u=new(Function.bind.apply(t,e));return r&&i(u,r.prototype),u}).apply(null,arguments)}var a=Symbol(),l=new WeakMap;function s(t,i,o){if(void 0===i&&(i=a),i===a)return Object.keys(t);var s,p=l.get(t)||l.set(t,(s=t,Object.values(s).flatMap(function(t){return function(t){return function t(n,r){var u=function(t,n){if(null==t)return{};var r,e,u={},c=Object.keys(t);for(e=0;e<c.length;e++)n.indexOf(r=c[e])>=0||(u[r]=t[r]);return u}(n,["id"]);return Object.entries(u).flatMap(function(n){var u=n[0],c=n[1];return e(c)?t(c,y(u,r)):y(u+"__."+c,r)})}(t).map(function(n){return function(t,n){return n.reduceRight(function(r,e,u){var c,i;return n.length-1<=u?((c={})[e]=t,c):((i={})[e]=r,i)},{})}([t.id],n.split("__."))})}(t)}).reduce(function(t,n){return u(t,n,function(t,n){if(Array.isArray(t))return t.concat(n)})},{}))).get(t),O=(Array.isArray(i)?i:[i]).map(function(t){return function(t,n){return r.apply(void 0,function t(n,r){return Object.keys(n).flatMap(function(u){var c;return e(n[u])?t(n[u],y(u,r)):((c={})[y(u,r)]=n[u],c)})}(n).map(function(n){return function t(n,r,e){if(!r.length)return d(e)?v(n,h(e)).map(function(t){return n[t]}).flat():n[""+e];var u=r[0],i=r.slice(1),o=d(u)?v(n,h(u)).reduce(function(t,r){return c({},t,n[r]||{})},{}):n[u];return o?t(o,i,e):[]}(t,Object.keys(n)[0].split("__."),Object.values(n)[0])}))}(p,t)});switch(o.conditions){case"all":return r.apply(void 0,O);case"any":return[].concat(f(Set,O));case"diff":return O.length>=2?n.apply(void 0,[O[0]].concat(O.slice(1))):[];case"none":return n.apply(void 0,[Object.keys(t)].concat(O));default:throw Error("Invalid Query Conditon: "+o.conditions)}}function p(t){return{conditions:(null==t?void 0:t.conditions)||"all"}}function d(t){try{return"string"==typeof t&&!!h(t)}catch(t){return!1}}function y(t,n){return void 0===n&&(n=a),n===a?""+t:n+"__."+t}function v(t,n){return Object.keys(t).filter(function(t){return n.test(t)})}function h(t){var n=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(n,r)}module.exports=function(t){return{filter:function(n,r){return s(t,n,p(r)).map(function(n){return t[n]})},search:function(n,r){return s(t,n,p(r))}}};
//# sourceMappingURL=index.js.map
